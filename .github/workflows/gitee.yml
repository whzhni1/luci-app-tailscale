name: 同步到 Gitee

on:
  push:
    branches: [ main, master ]

env:
  仓库名称: "luci-app-tailscale"
  GitHub用户名: "whzhni1"
  Gitee用户名: "whzhni"

jobs:
  同步任务:
    runs-on: ubuntu-latest
    steps:
      - name: 检出代码
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: 显示同步信息
        run: |
          echo "🚀 开始同步仓库到 Gitee"
          echo "📦 源仓库: github/${{ env.GitHub用户名 }}/${{ env.仓库名称 }}"
          echo "🎯 目标仓库: gitee/${{ env.Gitee用户名 }}/${{ env.仓库名称 }}"

      - name: 执行同步到Gitee
        uses: Yikun/hub-mirror-action@master
        with:
          src: github/${{ env.GitHub用户名 }}
          dst: gitee/${{ env.Gitee用户名 }}
          static_list: ${{ env.仓库名称 }}
          force_update: true
          debug: true
        env:
          # 关键修改：使用 GITEE_TOKEN 而不是 SSH 密钥
          GITEE_TOKEN: ${{ secrets.GITEE_TOKEN }}

      - name: 同步成功通知
        if: success()
        run: |
          echo "✅ 同步成功！Gitee 仓库已更新"
          echo "📊 查看最新代码: https://gitee.com/${{ env.Gitee用户名 }}/${{ env.仓库名称 }}"
